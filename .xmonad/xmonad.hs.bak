aoeu
-- TODO key to switch dvorak and qwerty
-- TODO .xinitrc move most of to here?

import qualified Data.Set as S

import XMonad ( KeySym
              , defaultConfig
              , t
import XMonad

-- Position-based config
-- (I use Dvorak)

--- MAIN CONFIGURATIOn ---

main = xmonad $ defaultConfig
    { normalBorderColor  = "#dddddd"
    , focusedBorderColor = "#dddddd"
    , terminal           = "terminal"  -- XFCE terminal
    , layoutHook         = error "aoeu"
    , manageHook         = error "aoeu"
    , handleEventHook    = error "aoeu"
    , workspaces         = [
                           -- 1-9
                           , "Programming 1"
                           , "Status"
                           , "Empty"
                           , "IRC"
                           , "Media"  -- music, web browsing, etc.
                           , "Programming 2"
                           , "Private 1"
                           , "Private 2"
                           , "Administration"

                           -- 'q'-'o' (qwerty)
                           , "Graphics 1"  -- primarily gimp
                           , 
                           , 
                           , 
                           , "Background 1"
                           , "Background 2"
                           ]
    , numlockMask        = mod2Mask
    , handleEventHook    = error "aoeu"
    , modMask            = mod4Mask
    , keys               = error "aoeu"
    , mouseBindings      = error "aoeu"
    , borderWidth        = 2
    , logHook            = error "aoeu"
    , startupHook        = error "aoeu"
    , focusFollowsMouse  = True
    }

--- KEY LAYOUTS ---

keyLayout :: KeyLayout
keyLayout = dvorak

newtype KeyLayout = KeyLayout {getKeyLayout :: S.Set KeyLayoutKey}

data KeyLayoutKey = KeyLayoutKey { klk_qwerty :: KeySym
                                 , klk_toKey  :: KeySym

qwerty :: KeyLayout
qwerty = KeyLayout . S.fromList $ []

dvorak :: KeyLayout
dvorak = KeyLayout . S.fromList . map (\(q, t) -> KeyLayoutKey {klk_qwerty = q, klk_toKey = t}) $
    [ (xK_a, xK_a)
    , (xK_b, xK_x)
    , (xK_c, xK_j)
    , (xK_d, xK_e)
    , (xK_e, xK_period)
    , (xK_f, xK_u)
    , (xK_g, xK_i)
    , (xK_h, xK_d)
    , (xK_i, xK_c)
    , (xK_j, xK_h)
    , (xK_k, xK_t)
    , (xK_l, xK_n)
    , (xK_m, xK_m)
    , (xK_n, xK_b)
    , (xK_o, xK_r)
    , (xK_p, xK_l)
    , (xK_q, xK_apostrophe)
    , (xK_r, xK_p)
    , (xK_s, xK_o)
    , (xK_t, xK_y)
    , (xK_u, xK_g)
    , (xK_v, xK_k)
    , (xK_w, xK_comma)
    , (xK_x, xK_q)
    , (xK_y, xK_f)
    , (xK_z, xK_semicolon)
    , (xK_bracketleft, xK_slash)
    , (xK_bracketright, xK_equal)
    , (xK_backslash, xK_backslash)
    , (xK_slash, xK_z)
    , (xK_equal, xK_bracketright)
    , (xK_minus, xK_bracketleft)
    , (xK_apostrophe, xK_minus)
    , (xK_comma, xK_w)
    , (xK_period, xK_v)
    , (xK_semicolon, xK_s)
    ]

    { modMask            = mod4Mask
    , borderWidth        = 2
    , focusedBorderColor = "#C11B17"
    , normalBorderColor  = "#2e3436"
    , manageHook          
    }
       { borderWidth		= 2
       , focusedBorderColor 	= "#C11B17"
       , normalBorderColor 	= "#2e3436"
       , manageHook    	= myManageHook <+> manageDocks
       , workspaces    	= map show [1 .. 9 :: Int]
       -- , terminal	= "urxvtc"
       -- , terminal	= "xterm"
       -- , terminal	= "urxvt"
       , terminal	= "terminal"  -- XFCE terminal
       -- , terminal	    = "xfce4-terminal"  -- XFCE terminal
       , modMask       	= mod4Mask
       , logHook       	= myLogHook
       , layoutHook    	= windowNavigation $ (avoidStruts (myTab ||| 
tall ||| Mirror tall ||| Circle))
       , keys 			= \c -> myKeys c `M.union` keys 
defaultConfig c
